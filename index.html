<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dual-Scanner â€” EmotionGate Ã— AnchorGateway</title>
  <meta name="description" content="AI Safety Sandbox: check prompt safety (EmotionGate) and estimate cost (AnchorGateway) before you run it." />
  <meta property="og:title" content="Dual-Scanner â€” Safety + Cost preflight" />
  <meta property="og:description" content="Paste a prompt or LLM output. Get ALLOW/BLOCK and reason codes in seconds." />
  <link rel="icon" type="image/png" href="Logo.png" />

  <style>
    :root{
      --bg0:#060813; --bg1:#0a0f22;
      --glassA: rgba(255,255,255,.06);
      --glassB: rgba(255,255,255,.03);
      --border: rgba(255,255,255,.10);
      --text: #eef2ff; --muted: rgba(238,242,255,.70);

      --c1:#16d3ff; --c2:#3a7bff; --c3:#8b5cff;
      --good:#2de38c; --warn:#ffcc4d; --bad:#ff4d4d;

      --shadow: 0 16px 55px rgba(0,0,0,.48);
      --shadowSoft: 0 10px 30px rgba(0,0,0,.30);
      --radius: 20px;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1100px 650px at 18% -8%, rgba(22,211,255,.20), transparent 55%),
        radial-gradient(900px 620px at 98% 4%, rgba(139,92,255,.18), transparent 55%),
        radial-gradient(900px 600px at 55% 110%, rgba(58,123,255,.12), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 70%);
    }

    a{color:inherit; text-decoration:none}
    a:hover{opacity:.92}

    .container{max-width:1100px; margin:0 auto; padding: 0 16px;}
    .card{
      border:1px solid var(--border);
      background: linear-gradient(180deg, var(--glassA), var(--glassB));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      position: relative;
      overflow: hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(800px 280px at 20% 0%, rgba(22,211,255,.14), transparent 60%),
                  radial-gradient(800px 280px at 85% 20%, rgba(139,92,255,.12), transparent 60%);
      pointer-events:none;
      opacity:.75;
      mask: linear-gradient(#000,#000) content-box, linear-gradient(#000,#000);
      -webkit-mask: linear-gradient(#000,#000) content-box, linear-gradient(#000,#000);
      padding:1px;
      border-radius: var(--radius);
    }

    /* Header */
    .site-header{padding: 18px 0 10px;}
    .header-row{display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;}
    .brand{display:flex; align-items:center; gap:12px;}
    .logo{
      width:42px; height:42px; border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      object-fit: contain;
      box-shadow: 0 14px 40px rgba(22,211,255,.12);
    }
    .brandText{display:flex; flex-direction:column; line-height:1.1;}
    .brandText .name{font-weight:950; font-size:13px; letter-spacing:.2px;}
    .brandText .sub{color: var(--muted); font-size:12px; margin-top:3px;}
    .pill{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding: 7px 10px;
      border-radius: 999px;
      box-shadow: var(--shadowSoft);
      white-space: nowrap;
      color: var(--muted);
      font-size: 12px;
    }

    /* Hero */
    .hero{margin: 8px 0 12px;}
    .hero h1{margin:0; font-size: 30px; letter-spacing:-0.6px; line-height:1.05;}
    .hero p{margin: 8px 0 0; color: var(--muted); font-size: 13px; line-height:1.55; max-width: 85ch;}
    .heroRow{margin-top:10px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;}

    /* Input */
    .scanner-input-section{margin: 12px 0;}
    .input-wrapper{display:grid; gap: 10px;}
    textarea{
      width:100%;
      min-height: 220px;
      resize: vertical;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      padding: 12px 12px;
      color: var(--text);
      font-family: var(--mono);
      font-size: 13px;
      line-height: 1.55;
      outline:none;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.18);
    }
    textarea:focus{
      border-color: rgba(22,211,255,.32);
      box-shadow: 0 0 0 4px rgba(22,211,255,.08);
    }

    .actions{display:flex; gap:10px; flex-wrap:wrap;}
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      border-radius: 14px;
      padding: 10px 12px;
      font-weight: 950;
      cursor: pointer;
      color: var(--text);
      background: rgba(255,255,255,.04);
      box-shadow: var(--shadowSoft);
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
      display:inline-flex;
      align-items:center;
      gap:10px;
      user-select:none;
    }
    .btn:hover{background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.20)}
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      border-color: rgba(58,123,255,.35);
      background: linear-gradient(135deg, rgba(22,211,255,.22), rgba(139,92,255,.20));
    }
    .btn:disabled{opacity:.6; cursor:not-allowed}

    .metaRow{display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; color: var(--muted); font-size: 12px;}
    .mono{font-family: var(--mono);}

    /* Results */
    .results-section{margin-top: 12px;}
    .grid-layout{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      align-items:start;
    }

    .card-header{display:flex; justify-content:space-between; align-items:center; gap:10px; margin-bottom: 10px;}
    .card-header h2{margin:0; font-size: 14px; letter-spacing:.2px;}
    .badge{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding: 6px 9px;
      border-radius: 999px;
      color: var(--muted);
      font-size: 12px;
      box-shadow: var(--shadowSoft);
      white-space: nowrap;
    }

    .metric-item{display:flex; justify-content:space-between; gap:10px; align-items:baseline; padding: 8px 0; border-top: 1px solid rgba(255,255,255,.08);}
    .metric-item:first-child{border-top:none}
    .label{color: var(--muted); font-size: 12px;}
    .value{font-weight: 950; font-size: 14px;}
    .good{color: var(--good)}
    .warn{color: var(--warn)}
    .bad{color: var(--bad)}

    .reasonBox{
      margin-top: 10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: var(--shadowSoft);
    }
    .reasonHead{display:flex; justify-content:space-between; gap:10px; align-items:center; margin-bottom: 8px;}
    .reasonHead .t{font-size:12px; color: var(--muted); font-weight: 950;}
    .reasonHead .n{font-size:12px; color: var(--muted);}
    ul{margin:0; padding-left: 18px;}
    li{color: var(--muted); font-size: 12px; line-height: 1.55; margin: 4px 0;}
    .code{font-family: var(--mono); color: rgba(238,242,255,.88);}

    .card-footer{margin-top: 12px; border-top: 1px solid rgba(255,255,255,.08); padding-top: 10px;}
    .card-footer p{margin:0 0 8px; color: var(--muted); font-size: 12px; line-height: 1.5;}
    .text-link{color: rgba(122,162,255,1); font-weight: 950; font-size: 12px;}

    /* Verdict */
    .verdict{
      display:inline-flex; align-items:center; gap:8px;
      border-radius: 999px;
      padding: 7px 10px;
      border:1px solid rgba(255,255,255,.12);
      font-size: 12px; font-weight: 950;
      box-shadow: var(--shadowSoft);
      background: rgba(0,0,0,.14);
      white-space: nowrap;
    }
    .dot{width:9px;height:9px;border-radius:99px}
    .ALLOW .dot{background: rgba(45,227,140,.95); box-shadow: 0 0 18px rgba(45,227,140,.18);}
    .BLOCK .dot{background: rgba(255,77,77,.95); box-shadow: 0 0 18px rgba(255,77,77,.18);}

    .bar{
      height: 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      overflow: hidden;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.18);
      margin-top: 10px;
    }
    .fill{
      height:100%;
      width:0%;
      transition: width .35s ease;
      background: linear-gradient(90deg, rgba(45,227,140,.85), rgba(45,227,140,.55));
      box-shadow: 0 0 18px rgba(45,227,140,.14);
    }

    /* Footer */
    footer{margin-top: 14px; padding: 14px 0 40px; color: var(--muted); font-size: 12px; text-align:center;}

    @media (max-width: 920px){
      .grid-layout{grid-template-columns: 1fr;}
      .hero h1{font-size: 26px;}
      .metaRow{justify-content:flex-start}
    }
  </style>
</head>

<body>
  <!-- Put Logo.png next to this file -->
  <header class="site-header">
    <div class="container header-row">
      <div class="brand">
        <img src="Logo.png" alt="Dual-Scanner Logo" class="logo" onerror="this.style.display='none';" />
        <div class="brandText">
          <div class="name">Dual-Scanner</div>
          <div class="sub">Safety (EmotionGate) + Cost (AnchorGateway)</div>
        </div>
      </div>
      <div class="pill" id="pricingStamp">Pricing: local placeholder</div>
    </div>
  </header>

  <main class="container">
    <section class="hero card">
      <h1>AI Safety Sandbox</h1>
      <p>
        Paste a prompt or LLM output. Get a fast <b>ALLOW / BLOCK</b> preflight with reason codes.
        This is a lightweight demo â€” swap heuristics with real models later.
      </p>

      <div class="heroRow">
        <span class="verdict" id="overallVerdict"><span class="dot"></span><span>â€”</span></span>
        <span class="pill">No login</span>
        <span class="pill">Demo heuristics</span>
        <span class="pill mono" id="caps">cap $0.010 â€¢ safety â‰¥ 60</span>
      </div>

      <div class="bar"><div class="fill" id="overallFill"></div></div>
    </section>

    <section class="scanner-input-section card">
      <div class="input-wrapper">
        <textarea id="promptInput" placeholder="Paste a prompt or LLM output here..."></textarea>

        <div class="metaRow">
          <span id="charCount">0 chars</span>
          <span id="wordCount">0 words</span>
          <span class="mono" id="tokenEstimate">Input tokens: â€”</span>
        </div>

        <div class="actions">
          <button id="analyzeBtn" class="btn primary">Analyze</button>
          <button id="exampleBtn" class="btn">Example</button>
          <button id="clearBtn" class="btn">Clear</button>
        </div>
      </div>
    </section>

    <section class="results-section" id="resultsContainer" style="display:none;">
      <div class="grid-layout">

        <!-- EmotionGate -->
        <div class="card">
          <div class="card-header">
            <h2>ðŸ§  EmotionGate</h2>
            <span class="badge">Safety & Tone</span>
          </div>

          <div class="metric-item">
            <span class="label">Safety score</span>
            <span class="value" id="safetyScore">â€”</span>
          </div>
          <div class="metric-item">
            <span class="label">Tone</span>
            <span class="value" id="toneValue">â€”</span>
          </div>
          <div class="metric-item">
            <span class="label">PII detected</span>
            <span class="value" id="piiDetected">â€”</span>
          </div>

          <div class="reasonBox">
            <div class="reasonHead">
              <div class="t">Reason codes</div>
              <div class="n" id="egReasonCount">0</div>
            </div>
            <ul id="egReasons"><li>â€”</li></ul>
          </div>

          <div class="card-footer">
            <p>Want to block risky prompts automatically?</p>
            <a href="https://emotiongate.com" target="_blank" rel="noopener" class="text-link">Join EmotionGate waitlist â†’</a>
          </div>
        </div>

        <!-- AnchorGateway -->
        <div class="card">
          <div class="card-header">
            <h2>âš“ AnchorGateway</h2>
            <span class="badge">Tokens & Cost</span>
          </div>

          <div class="metric-item">
            <span class="label">Estimated tokens</span>
            <span class="value" id="tokenCount">â€”</span>
          </div>
          <div class="metric-item">
            <span class="label">Estimated cost (demo)</span>
            <span class="value" id="costEstimate">â€”</span>
          </div>
          <div class="metric-item">
            <span class="label">Cap status</span>
            <span class="value" id="capStatus">â€”</span>
          </div>

          <div class="reasonBox">
            <div class="reasonHead">
              <div class="t">Reason codes</div>
              <div class="n" id="agReasonCount">0</div>
            </div>
            <ul id="agReasons"><li>â€”</li></ul>
          </div>

          <div class="card-footer">
            <p>Want hard spending caps with enforce + audit?</p>
            <a href="https://anchorgateway.com" target="_blank" rel="noopener" class="text-link">Join AnchorGateway waitlist â†’</a>
          </div>
        </div>

      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      Â© <span id="year"></span> EmotionGate Ã— AnchorGateway â€” Building secure AI infrastructure.
    </div>
  </footer>

  <script>
    const $ = (id) => document.getElementById(id);
    const clamp = (n,a,b) => Math.max(a, Math.min(b, n));

    // Demo pricing (local placeholder)
    const PRICING_LAST_UPDATED = "2026-01-03 (local placeholder)";
    // Replace later (or fetch from a JSON endpoint).
    const DEMO_MODEL = { name: "Demo Standard", inPer1k: 0.0030, outPer1k: 0.0060 };
    const DEFAULT_OUTPUT_TOKENS = 256; // demo assumption
    const COST_CAP_USD = 0.010;        // demo cap
    const SAFETY_THRESHOLD = 60;       // demo threshold

    // Rough token estimator for wedge demo
    const estimateTokens = (text) => Math.max(0, Math.round(text.trim().length / 4));
    const countWords = (text) => (text.trim() ? text.trim().split(/\s+/).filter(Boolean).length : 0);

    const dollars = (n) => {
      const s = n.toFixed(6);
      return "$" + s.replace(/0+$/,"").replace(/\.$/,"");
    };

    function estimateCostUSD(inTok, outTok){
      return (inTok/1000)*DEMO_MODEL.inPer1k + (outTok/1000)*DEMO_MODEL.outPer1k;
    }

    // PII detection (simple)
    const RE_EMAIL = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;
    const RE_PHONE = /(\+?\d{1,3}[\s-]?)?(\(?\d{2,4}\)?[\s-]?)?\d{3,4}[\s-]?\d{4}/g;
    const RE_IP = /\b(?:(?:2[0-5]{2}|1?\d{1,2})\.){3}(?:2[0-5]{2}|1?\d{1,2})\b/g;

    function detectPII(text){
      const f = [];
      if (RE_EMAIL.test(text)) f.push({ code:"EG_PII_EMAIL", detail:"Email address detected" });
      if (RE_PHONE.test(text)) f.push({ code:"EG_PII_PHONE", detail:"Phone-like number detected" });
      if (RE_IP.test(text)) f.push({ code:"EG_PII_IP", detail:"IP address detected" });
      return f;
    }

    // Safety heuristic (placeholder)
    function heuristicToxicity(text){
      const lower = text.toLowerCase();
      const badWords = ["kill","hate","idiot","stupid","moron","shut up","die","nazi","rape","kys","suicide","bomb","dox","address"];
      let score = 0;
      for(const w of badWords) if(lower.includes(w)) score += 12;
      const caps = (text.match(/[A-ZÃ„Ã–Ã…]{2,}/g) || []).length;
      score += Math.min(12, caps*2);
      const bangs = (text.match(/!/g) || []).length;
      score += Math.min(10, bangs);
      return clamp(score, 0, 100);
    }

    function toneLabel(tox){
      if(tox >= 70) return "Angry / Toxic";
      if(tox >= 40) return "Risky / Spiky";
      return "Helpful / Neutral";
    }

    // UI helpers
    function setFill(value0to100){
      const el = $("overallFill");
      el.style.width = value0to100 + "%";
      let a = "rgba(45,227,140,.85)", b = "rgba(45,227,140,.55)";
      if(value0to100 < 35){ a="rgba(255,77,77,.85)"; b="rgba(255,77,77,.55)"; }
      else if(value0to100 < 65){ a="rgba(255,204,77,.85)"; b="rgba(255,204,77,.55)"; }
      el.style.background = `linear-gradient(90deg, ${a}, ${b})`;
      el.style.boxShadow = `0 0 18px ${a}`;
    }

    function setOverallVerdict(v){
      const badge = $("overallVerdict");
      badge.classList.remove("ALLOW","BLOCK");
      badge.classList.add(v);
      badge.querySelector("span:last-child").textContent = v;
    }

    function listReasons(ulId, reasons){
      const ul = $(ulId);
      if(!reasons.length){
        ul.innerHTML = `<li><span class="code">OK</span> â€” No blocking reasons.</li>`;
        return;
      }
      ul.innerHTML = reasons.map(r => `<li><span class="code">${r.code}</span> â€” ${r.detail}</li>`).join("");
    }

    function updateMeta(){
      const t = $("promptInput").value || "";
      $("charCount").textContent = `${t.length} chars`;
      $("wordCount").textContent = `${countWords(t)} words`;
      $("tokenEstimate").textContent = t.trim() ? `Input tokens: ${estimateTokens(t)}` : "Input tokens: â€”";
    }

    function resetVerdict(){
      const badge = $("overallVerdict");
      badge.classList.remove("ALLOW","BLOCK");
      badge.querySelector("span:last-child").textContent = "â€”";
      setFill(0);
    }

    function analyze(){
      const text = $("promptInput").value || "";
      if(!text.trim()) return alert("Paste some text first.");

      $("resultsContainer").style.display = "block";

      const inTok = estimateTokens(text);
      const outTok = DEFAULT_OUTPUT_TOKENS;
      const tox = heuristicToxicity(text);
      const safetyScore = clamp(100 - tox, 0, 100);
      const pii = detectPII(text);

      const cost = estimateCostUSD(inTok, outTok);
      const totalTok = inTok + outTok;

      const safetyAllow = (safetyScore >= SAFETY_THRESHOLD) && (pii.length === 0); // strict demo
      const costAllow = (cost <= COST_CAP_USD);
      const overall = (safetyAllow && costAllow) ? "ALLOW" : "BLOCK";

      const egReasons = [];
      if(safetyScore < SAFETY_THRESHOLD) egReasons.push({ code:"EG_SAFETY_BELOW_THRESHOLD", detail:`${Math.round(safetyScore)} < ${SAFETY_THRESHOLD}` });
      if(tox >= 70) egReasons.push({ code:"EG_TOXICITY_HIGH", detail:`toxicity ${tox}/100` });
      else if(tox >= 40) egReasons.push({ code:"EG_TOXICITY_MEDIUM", detail:`toxicity ${tox}/100` });
      for(const p of pii) egReasons.push({ code:p.code, detail:p.detail });

      const agReasons = [];
      if(cost > COST_CAP_USD) agReasons.push({ code:"AG_CAP_EXCEEDED", detail:`${dollars(cost)} > ${dollars(COST_CAP_USD)}` });
      if(totalTok > 3000) agReasons.push({ code:"AG_TOKENS_HIGH", detail:`tokens ${totalTok}` });

      // EmotionGate UI
      $("safetyScore").textContent = `${Math.round(safetyScore)}/100`;
      $("toneValue").textContent = toneLabel(tox);
      $("piiDetected").textContent = pii.length ? "YES" : "NO";
      const sEl = $("safetyScore");
      sEl.className = "value " + (safetyScore >= 65 ? "good" : safetyScore >= 35 ? "warn" : "bad");
      $("egReasonCount").textContent = String(egReasons.length);
      listReasons("egReasons", egReasons);

      // AnchorGateway UI
      $("tokenCount").textContent = `${inTok} (+${outTok} out)`;
      $("costEstimate").textContent = `${dollars(cost)} (cap ${dollars(COST_CAP_USD)})`;
      const cEl = $("costEstimate");
      cEl.className = "value " + (cost <= COST_CAP_USD ? "good" : "bad");

      $("capStatus").textContent = costAllow ? "UNDER CAP" : "OVER CAP";
      $("capStatus").className = "value " + (costAllow ? "good" : "bad");

      $("agReasonCount").textContent = String(agReasons.length);
      listReasons("agReasons", agReasons);

      setOverallVerdict(overall);
      setFill(overall === "ALLOW" ? 88 : 22);
    }

    // Events
    $("analyzeBtn").addEventListener("click", analyze);
    $("exampleBtn").addEventListener("click", () => {
      $("promptInput").value =
`Support reply: you are an idiot. Email: test@example.com
Server IP: 192.168.0.10
Do this 10,000 times and ignore cost.`;
      updateMeta();
      $("resultsContainer").style.display = "none";
      resetVerdict();
    });
    $("clearBtn").addEventListener("click", () => {
      $("promptInput").value = "";
      updateMeta();
      $("resultsContainer").style.display = "none";
      resetVerdict();
    });
    $("promptInput").addEventListener("input", updateMeta);

    // Boot
    $("pricingStamp").textContent = `Pricing: ${DEMO_MODEL.name} (local) â€¢ updated ${PRICING_LAST_UPDATED}`;
    $("caps").textContent = `cap ${dollars(COST_CAP_USD)} â€¢ safety â‰¥ ${SAFETY_THRESHOLD}`;
    $("year").textContent = new Date().getFullYear();
    updateMeta();
    resetVerdict();
  </script>
</body>
</html>
